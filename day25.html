<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Learning</title>
</head>
<body>

    <div style="text-align: center">
        <h2
          style="
            background-color: blueviolet;
            color: white;
            text-transform: uppercase;
          "
        >
          Learning JavaScript
        </h2>
      </div>


    <script>
   
   //JavaScript - Event Loop

        let fun2 = () =>{
       
            setTimeout(()=>{
                console.log("fun2 is called!!");
            },3000);

        }

        let fun1 = ()=>{
       
            console.log("fun1 is starting!!");
            fun2();
            console.log("fun1 is ending!!");
        }

        fun1();

       //Callback is used for Asynchronous programming.

       let Students = [
        {rollNo:1,name:"Ajeet",age:20},
        {rollNo:2,name:"Chandan",age:30},
        {rollNo:3,name:"Pawan",age:10}
       ];

       let getRollNo = () =>{
        setTimeout(()=>{
          let ROLLNO = [1,2,3];
          console.log(ROLLNO);
          setTimeout((rollNo)=>{
           let studentDetails = Students.find(x=>x.rollNo == rollNo)
           console.log(studentDetails);
           setTimeout((name)=>{
            console.log(`Student name is ${name}`);
           },3000,studentDetails.name);
          },3000,ROLLNO[0]);
        },3000)
       }

       getRollNo();


       console.log("Hello World!!");


       //Promises in javascript

       let Stu = [
        {rollNo:10,name:"Rama",age:20},
        {rollNo:20,name:"Shanti",age:30},
        {rollNo:30,name:"Sheela",age:10}
       ];

       //executor
       let obj = new Promise((resolve,reject)=>{
        setTimeout(()=>{
          let statusCode=200;
          if(statusCode==200)
          {
            let ROLLNO = [10,20,30];
            resolve(ROLLNO);
          }
          else
          {
            reject("An error occured while getting list of student rollnos!!");
          }
        },3000);
       
       });


       console.log("\n");


       let studentDetails = (rollNo)=>{

        return new Promise((resolve,reject)=>{

          setTimeout(()=>{
          let statusCode=200;
          if(statusCode==200)
          {
            let studentInfo = Stu.find(x=>x.rollNo == rollNo)
            resolve(studentInfo);
          }
          else
          {
            reject("An error occured while getting list of student rollnos!!");
          }
        },3000);

        })

       }

       //consumer
       obj.then((rollNos)=>{

        console.log(rollNos);

        studentDetails(rollNos[1]).then((result)=>{
          console.log(result);
        }).catch((err)=>{
         console.log(err);
       })

       }).catch((err)=>{
         console.log(err);
       })


    </script>
</body>
</html>